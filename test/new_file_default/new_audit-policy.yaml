apiVersion: audit.k8s.io/v1
kind: Policy
rules:
- level: null
  userGroups:
  - system:serviceaccounts:kube-system
- level: null
  users:
  - system:unsecured
  namespaces:
  - kube-system
  verbs:
  - get
  resources:
  - group: ""
    resources:
    - configmaps
- level: null
  users:
  - kubelet
  verbs:
  - get
  resources:
  - group: ""
    resources:
    - nodes
- level: null
  userGroups:
  - system:nodes
  verbs:
  - get
  - patch
  resources:
  - group: ""
    resources:
    - nodes
- level: null
  userGroups:
  - system:nodes
  verbs:
  - get
  resources:
  - group: ""
    resources:
    - secrets
- level: null
  users:
  - system:kube-controller-manager
  - system:kube-scheduler
  - system:serviceaccount:kube-system:endpoint-controller
  verbs:
  - get
  - update
  namespaces:
  - kube-system
  resources:
  - group: ""
    resources:
    - endpoints
- level: null
  users:
  - system:apiserver
  verbs:
  - get
  resources:
  - group: ""
    resources:
    - namespaces
- level: null
  nonResourceURLs:
  - /healthz*
  - /version
  - /openapi/v2*
  - /readyz*
  - /livez*
- level: null
  resources:
  - group: ""
    resources:
    - events
  - group: events.k8s.io
    resources:
    - events
- level: Metadata
  resources:
  - group: ""
    resources:
    - secrets
    - configmaps
  - group: authentication.k8s.io
    resources:
    - tokenreviews
- level: Request
  verbs:
  - create
  - delete
  - update
  - patch
  resources:
  - group: ""
    resources:
    - persistentvolumeclaims
    - persistentvolumes
- level: Request
  verbs:
  - create
  - update
  - patch
  resources:
  - group: ""
    resources:
    - pods
    - replicacontrollers
    - container
  - group: apps
    resources:
    - daemonsets
    - deployments
    - replicasets
    - statefulsets
  - group: batch
    resources:
    - jobs
    - cronjobs
  - group: extensions
    resources:
    - daemonsets
    - deployments
    - replicasets
- level: RequestResponse
  verbs:
  - create
  - update
  - delete
  - patch
  resources:
  - group: crd.projectcalico.org
- level: null
  resources:
  - group: apiregistration.k8s.io
  - group: coordination.k8s.io
- level: Metadata
  verbs:
  - create
  - update
  - delete
  - patch
